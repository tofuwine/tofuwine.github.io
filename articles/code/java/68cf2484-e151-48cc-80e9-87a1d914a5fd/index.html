<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„åŒºåˆ«ä¸ä½¿ç”¨ | Tofuwine's Blog</title>
<meta name=keywords content><meta name=description content="æ–‡ä¸­ä»£ç åŸºäº Java 17
Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„å¼‚åŒ Spring çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ä¸ Servlet çš„ Filter æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œæ¯”å¦‚äºŒè€…éƒ½æ˜¯ AOP ç¼–ç¨‹æ€æƒ³çš„ä½“ç°ï¼Œéƒ½èƒ½å®ç°æƒé™æ£€æŸ¥ã€æ—¥å¿—è®°å½•ç­‰ã€‚
ä¸åŒçš„æ˜¯ï¼š
ä½¿ç”¨èŒƒå›´ä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒè§„å®šçš„ï¼Œåªèƒ½ç”¨äº Web ç¨‹åºä¸­ã€‚è€Œæ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨äº Web ç¨‹åºï¼Œä¹Ÿå¯ä»¥ç”¨äº Applicationã€Swing ç­‰ç¨‹åºä¸­ã€‚ è§„èŒƒä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒä¸­å®šä¹‰çš„ï¼Œæ˜¯ Servlet å®¹å™¨æ”¯æŒçš„ã€‚è€Œæ‹¦æˆªå™¨æ˜¯åœ¨ Spring å®¹å™¨å†…çš„ï¼Œæ˜¯ Spring æ¡†æ¶æ”¯æŒçš„ã€‚ ä½¿ç”¨èµ„æºä¸åŒï¼šåŒå…¶ä»–ä»£ç å—ä¸€æ ·ï¼ŒInterceptor ä¹Ÿæ˜¯ä¸€ä¸ª Spring çš„ç»„ä»¶ï¼Œå½’ Spring ç®¡ç†ï¼Œé…ç½®åœ¨ Spring æ–‡ä»¶ä¸­ï¼Œå› æ­¤èƒ½ä½¿ç”¨ Spring é‡Œçš„ä»»ä½•èµ„æºã€å¯¹è±¡ï¼Œä¾‹å¦‚ Service å¯¹è±¡ã€æ•°æ®æºã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œé€šè¿‡ IoC æ³¨å…¥æ‹¦æˆªå™¨å³å¯ã€‚è€Œ Filter åˆ™ä¸èƒ½ã€‚ æ·±åº¦ä¸åŒï¼šFilter åªåœ¨ Servlet å‰åèµ·ä½œç”¨ã€‚è€Œæ‹¦æˆªå™¨èƒ½å¤Ÿæ·±å…¥åˆ°æ–¹æ³•å‰åã€å¼‚å¸¸æŠ›å‡ºå‰åç­‰ã€‚å› æ­¤æ‹¦æˆªå™¨çš„ä½¿ç”¨å…·æœ‰æ›´å¤§çš„å¼¹æ€§ã€‚æ‰€ä»¥åœ¨ Spring æ¶æ„çš„ç¨‹åºä¸­ï¼Œè¦ä¼˜å…ˆä½¿ç”¨æ‹¦æˆªå™¨ã€‚ å¯¹äºä¸€ä¸ªè¯·æ±‚ï¼Œæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š
flowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --> B --> C --> D --> E --> F ä½•æ—¶ä½¿ç”¨ Filterã€Interceptorï¼Ÿ å¦‚æœæ˜¯é Spring é¡¹ç›®ï¼Œé‚£ä¹ˆæ‹¦æˆªå™¨ä¸èƒ½ç”¨ï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† Controller å‰åï¼Œæ—¢å¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† DispatcherServlet å‰åï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ Spring Boot ä½¿ç”¨ Filter Spring Boot ä½¿ç”¨ Filter æœ‰ä¸¤ç§æ–¹å¼ï¼š"><meta name=author content="tofuwine"><link rel=canonical href=https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://tofuwine.github.io/images/favicon.svg><link rel=icon type=image/png sizes=16x16 href=https://tofuwine.github.io/images/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://tofuwine.github.io/images/favicon.svg><link rel=apple-touch-icon href=https://tofuwine.github.io/images/favicon.svg><link rel=mask-icon href=https://tofuwine.github.io/images/favicon.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".parent");e.forEach(function(e){e.addEventListener("click",function(){const e=this.querySelector(".sub-menu");e.classList.toggle("active")})})})</script><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/tofuwine/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/tofuwine/fancybox@3.5.7/dist/jquery.fancybox.min.js></script><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
</script><meta property="og:title" content="Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„åŒºåˆ«ä¸ä½¿ç”¨"><meta property="og:description" content="æ–‡ä¸­ä»£ç åŸºäº Java 17
Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„å¼‚åŒ Spring çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ä¸ Servlet çš„ Filter æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œæ¯”å¦‚äºŒè€…éƒ½æ˜¯ AOP ç¼–ç¨‹æ€æƒ³çš„ä½“ç°ï¼Œéƒ½èƒ½å®ç°æƒé™æ£€æŸ¥ã€æ—¥å¿—è®°å½•ç­‰ã€‚
ä¸åŒçš„æ˜¯ï¼š
ä½¿ç”¨èŒƒå›´ä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒè§„å®šçš„ï¼Œåªèƒ½ç”¨äº Web ç¨‹åºä¸­ã€‚è€Œæ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨äº Web ç¨‹åºï¼Œä¹Ÿå¯ä»¥ç”¨äº Applicationã€Swing ç­‰ç¨‹åºä¸­ã€‚ è§„èŒƒä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒä¸­å®šä¹‰çš„ï¼Œæ˜¯ Servlet å®¹å™¨æ”¯æŒçš„ã€‚è€Œæ‹¦æˆªå™¨æ˜¯åœ¨ Spring å®¹å™¨å†…çš„ï¼Œæ˜¯ Spring æ¡†æ¶æ”¯æŒçš„ã€‚ ä½¿ç”¨èµ„æºä¸åŒï¼šåŒå…¶ä»–ä»£ç å—ä¸€æ ·ï¼ŒInterceptor ä¹Ÿæ˜¯ä¸€ä¸ª Spring çš„ç»„ä»¶ï¼Œå½’ Spring ç®¡ç†ï¼Œé…ç½®åœ¨ Spring æ–‡ä»¶ä¸­ï¼Œå› æ­¤èƒ½ä½¿ç”¨ Spring é‡Œçš„ä»»ä½•èµ„æºã€å¯¹è±¡ï¼Œä¾‹å¦‚ Service å¯¹è±¡ã€æ•°æ®æºã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œé€šè¿‡ IoC æ³¨å…¥æ‹¦æˆªå™¨å³å¯ã€‚è€Œ Filter åˆ™ä¸èƒ½ã€‚ æ·±åº¦ä¸åŒï¼šFilter åªåœ¨ Servlet å‰åèµ·ä½œç”¨ã€‚è€Œæ‹¦æˆªå™¨èƒ½å¤Ÿæ·±å…¥åˆ°æ–¹æ³•å‰åã€å¼‚å¸¸æŠ›å‡ºå‰åç­‰ã€‚å› æ­¤æ‹¦æˆªå™¨çš„ä½¿ç”¨å…·æœ‰æ›´å¤§çš„å¼¹æ€§ã€‚æ‰€ä»¥åœ¨ Spring æ¶æ„çš„ç¨‹åºä¸­ï¼Œè¦ä¼˜å…ˆä½¿ç”¨æ‹¦æˆªå™¨ã€‚ å¯¹äºä¸€ä¸ªè¯·æ±‚ï¼Œæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š
flowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --> B --> C --> D --> E --> F ä½•æ—¶ä½¿ç”¨ Filterã€Interceptorï¼Ÿ å¦‚æœæ˜¯é Spring é¡¹ç›®ï¼Œé‚£ä¹ˆæ‹¦æˆªå™¨ä¸èƒ½ç”¨ï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† Controller å‰åï¼Œæ—¢å¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† DispatcherServlet å‰åï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ Spring Boot ä½¿ç”¨ Filter Spring Boot ä½¿ç”¨ Filter æœ‰ä¸¤ç§æ–¹å¼ï¼š"><meta property="og:type" content="article"><meta property="og:url" content="https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/"><meta property="article:section" content="articles"><meta property="article:published_time" content="2024-05-07T14:14:08+08:00"><meta property="og:site_name" content="Tofuwine's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„åŒºåˆ«ä¸ä½¿ç”¨"><meta name=twitter:description content="æ–‡ä¸­ä»£ç åŸºäº Java 17
Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„å¼‚åŒ Spring çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ä¸ Servlet çš„ Filter æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œæ¯”å¦‚äºŒè€…éƒ½æ˜¯ AOP ç¼–ç¨‹æ€æƒ³çš„ä½“ç°ï¼Œéƒ½èƒ½å®ç°æƒé™æ£€æŸ¥ã€æ—¥å¿—è®°å½•ç­‰ã€‚
ä¸åŒçš„æ˜¯ï¼š
ä½¿ç”¨èŒƒå›´ä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒè§„å®šçš„ï¼Œåªèƒ½ç”¨äº Web ç¨‹åºä¸­ã€‚è€Œæ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨äº Web ç¨‹åºï¼Œä¹Ÿå¯ä»¥ç”¨äº Applicationã€Swing ç­‰ç¨‹åºä¸­ã€‚ è§„èŒƒä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒä¸­å®šä¹‰çš„ï¼Œæ˜¯ Servlet å®¹å™¨æ”¯æŒçš„ã€‚è€Œæ‹¦æˆªå™¨æ˜¯åœ¨ Spring å®¹å™¨å†…çš„ï¼Œæ˜¯ Spring æ¡†æ¶æ”¯æŒçš„ã€‚ ä½¿ç”¨èµ„æºä¸åŒï¼šåŒå…¶ä»–ä»£ç å—ä¸€æ ·ï¼ŒInterceptor ä¹Ÿæ˜¯ä¸€ä¸ª Spring çš„ç»„ä»¶ï¼Œå½’ Spring ç®¡ç†ï¼Œé…ç½®åœ¨ Spring æ–‡ä»¶ä¸­ï¼Œå› æ­¤èƒ½ä½¿ç”¨ Spring é‡Œçš„ä»»ä½•èµ„æºã€å¯¹è±¡ï¼Œä¾‹å¦‚ Service å¯¹è±¡ã€æ•°æ®æºã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œé€šè¿‡ IoC æ³¨å…¥æ‹¦æˆªå™¨å³å¯ã€‚è€Œ Filter åˆ™ä¸èƒ½ã€‚ æ·±åº¦ä¸åŒï¼šFilter åªåœ¨ Servlet å‰åèµ·ä½œç”¨ã€‚è€Œæ‹¦æˆªå™¨èƒ½å¤Ÿæ·±å…¥åˆ°æ–¹æ³•å‰åã€å¼‚å¸¸æŠ›å‡ºå‰åç­‰ã€‚å› æ­¤æ‹¦æˆªå™¨çš„ä½¿ç”¨å…·æœ‰æ›´å¤§çš„å¼¹æ€§ã€‚æ‰€ä»¥åœ¨ Spring æ¶æ„çš„ç¨‹åºä¸­ï¼Œè¦ä¼˜å…ˆä½¿ç”¨æ‹¦æˆªå™¨ã€‚ å¯¹äºä¸€ä¸ªè¯·æ±‚ï¼Œæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š
flowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --> B --> C --> D --> E --> F ä½•æ—¶ä½¿ç”¨ Filterã€Interceptorï¼Ÿ å¦‚æœæ˜¯é Spring é¡¹ç›®ï¼Œé‚£ä¹ˆæ‹¦æˆªå™¨ä¸èƒ½ç”¨ï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† Controller å‰åï¼Œæ—¢å¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† DispatcherServlet å‰åï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ Spring Boot ä½¿ç”¨ Filter Spring Boot ä½¿ç”¨ Filter æœ‰ä¸¤ç§æ–¹å¼ï¼š"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ğŸ“ æ–‡ç« ","item":"https://tofuwine.github.io/articles/"},{"@type":"ListItem","position":2,"name":"ğŸ–¥ï¸ è®¡ç®—æœºç¼–ç¨‹æŠ€æœ¯","item":"https://tofuwine.github.io/articles/code/"},{"@type":"ListItem","position":3,"name":"Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„åŒºåˆ«ä¸ä½¿ç”¨","item":"https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„åŒºåˆ«ä¸ä½¿ç”¨","name":"Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„åŒºåˆ«ä¸ä½¿ç”¨","description":"æ–‡ä¸­ä»£ç åŸºäº Java 17 Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„å¼‚åŒ Spring çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ä¸ Servlet çš„ Filter æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œæ¯”å¦‚äºŒè€…éƒ½æ˜¯ AOP ç¼–ç¨‹æ€æƒ³çš„ä½“ç°ï¼Œéƒ½èƒ½å®ç°æƒé™æ£€æŸ¥ã€æ—¥å¿—è®°å½•ç­‰ã€‚ ä¸åŒçš„æ˜¯ï¼š ä½¿ç”¨èŒƒå›´ä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒè§„å®šçš„ï¼Œåªèƒ½ç”¨äº Web ç¨‹åºä¸­ã€‚è€Œæ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨äº Web ç¨‹åºï¼Œä¹Ÿå¯ä»¥ç”¨äº Applicationã€Swing ç­‰ç¨‹åºä¸­ã€‚ è§„èŒƒä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒä¸­å®šä¹‰çš„ï¼Œæ˜¯ Servlet å®¹å™¨æ”¯æŒçš„ã€‚è€Œæ‹¦æˆªå™¨æ˜¯åœ¨ Spring å®¹å™¨å†…çš„ï¼Œæ˜¯ Spring æ¡†æ¶æ”¯æŒçš„ã€‚ ä½¿ç”¨èµ„æºä¸åŒï¼šåŒå…¶ä»–ä»£ç å—ä¸€æ ·ï¼ŒInterceptor ä¹Ÿæ˜¯ä¸€ä¸ª Spring çš„ç»„ä»¶ï¼Œå½’ Spring ç®¡ç†ï¼Œé…ç½®åœ¨ Spring æ–‡ä»¶ä¸­ï¼Œå› æ­¤èƒ½ä½¿ç”¨ Spring é‡Œçš„ä»»ä½•èµ„æºã€å¯¹è±¡ï¼Œä¾‹å¦‚ Service å¯¹è±¡ã€æ•°æ®æºã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œé€šè¿‡ IoC æ³¨å…¥æ‹¦æˆªå™¨å³å¯ã€‚è€Œ Filter åˆ™ä¸èƒ½ã€‚ æ·±åº¦ä¸åŒï¼šFilter åªåœ¨ Servlet å‰åèµ·ä½œç”¨ã€‚è€Œæ‹¦æˆªå™¨èƒ½å¤Ÿæ·±å…¥åˆ°æ–¹æ³•å‰åã€å¼‚å¸¸æŠ›å‡ºå‰åç­‰ã€‚å› æ­¤æ‹¦æˆªå™¨çš„ä½¿ç”¨å…·æœ‰æ›´å¤§çš„å¼¹æ€§ã€‚æ‰€ä»¥åœ¨ Spring æ¶æ„çš„ç¨‹åºä¸­ï¼Œè¦ä¼˜å…ˆä½¿ç”¨æ‹¦æˆªå™¨ã€‚ å¯¹äºä¸€ä¸ªè¯·æ±‚ï¼Œæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š flowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --\u003e B --\u003e C --\u003e D --\u003e E --\u003e F ä½•æ—¶ä½¿ç”¨ Filterã€Interceptorï¼Ÿ å¦‚æœæ˜¯é Spring é¡¹ç›®ï¼Œé‚£ä¹ˆæ‹¦æˆªå™¨ä¸èƒ½ç”¨ï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† Controller å‰åï¼Œæ—¢å¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† DispatcherServlet å‰åï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ Spring Boot ä½¿ç”¨ Filter Spring Boot ä½¿ç”¨ Filter æœ‰ä¸¤ç§æ–¹å¼ï¼š","keywords":[""],"articleBody":" æ–‡ä¸­ä»£ç åŸºäº Java 17\nSpring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„å¼‚åŒ Spring çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ä¸ Servlet çš„ Filter æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œæ¯”å¦‚äºŒè€…éƒ½æ˜¯ AOP ç¼–ç¨‹æ€æƒ³çš„ä½“ç°ï¼Œéƒ½èƒ½å®ç°æƒé™æ£€æŸ¥ã€æ—¥å¿—è®°å½•ç­‰ã€‚\nä¸åŒçš„æ˜¯ï¼š\nä½¿ç”¨èŒƒå›´ä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒè§„å®šçš„ï¼Œåªèƒ½ç”¨äº Web ç¨‹åºä¸­ã€‚è€Œæ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨äº Web ç¨‹åºï¼Œä¹Ÿå¯ä»¥ç”¨äº Applicationã€Swing ç­‰ç¨‹åºä¸­ã€‚ è§„èŒƒä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒä¸­å®šä¹‰çš„ï¼Œæ˜¯ Servlet å®¹å™¨æ”¯æŒçš„ã€‚è€Œæ‹¦æˆªå™¨æ˜¯åœ¨ Spring å®¹å™¨å†…çš„ï¼Œæ˜¯ Spring æ¡†æ¶æ”¯æŒçš„ã€‚ ä½¿ç”¨èµ„æºä¸åŒï¼šåŒå…¶ä»–ä»£ç å—ä¸€æ ·ï¼ŒInterceptor ä¹Ÿæ˜¯ä¸€ä¸ª Spring çš„ç»„ä»¶ï¼Œå½’ Spring ç®¡ç†ï¼Œé…ç½®åœ¨ Spring æ–‡ä»¶ä¸­ï¼Œå› æ­¤èƒ½ä½¿ç”¨ Spring é‡Œçš„ä»»ä½•èµ„æºã€å¯¹è±¡ï¼Œä¾‹å¦‚ Service å¯¹è±¡ã€æ•°æ®æºã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œé€šè¿‡ IoC æ³¨å…¥æ‹¦æˆªå™¨å³å¯ã€‚è€Œ Filter åˆ™ä¸èƒ½ã€‚ æ·±åº¦ä¸åŒï¼šFilter åªåœ¨ Servlet å‰åèµ·ä½œç”¨ã€‚è€Œæ‹¦æˆªå™¨èƒ½å¤Ÿæ·±å…¥åˆ°æ–¹æ³•å‰åã€å¼‚å¸¸æŠ›å‡ºå‰åç­‰ã€‚å› æ­¤æ‹¦æˆªå™¨çš„ä½¿ç”¨å…·æœ‰æ›´å¤§çš„å¼¹æ€§ã€‚æ‰€ä»¥åœ¨ Spring æ¶æ„çš„ç¨‹åºä¸­ï¼Œè¦ä¼˜å…ˆä½¿ç”¨æ‹¦æˆªå™¨ã€‚ å¯¹äºä¸€ä¸ªè¯·æ±‚ï¼Œæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š\nflowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --\u003e B --\u003e C --\u003e D --\u003e E --\u003e F ä½•æ—¶ä½¿ç”¨ Filterã€Interceptorï¼Ÿ å¦‚æœæ˜¯é Spring é¡¹ç›®ï¼Œé‚£ä¹ˆæ‹¦æˆªå™¨ä¸èƒ½ç”¨ï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† Controller å‰åï¼Œæ—¢å¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ å¦‚æœæ˜¯å¤„ç† DispatcherServlet å‰åï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ Spring Boot ä½¿ç”¨ Filter Spring Boot ä½¿ç”¨ Filter æœ‰ä¸¤ç§æ–¹å¼ï¼š\nä½¿ç”¨ Spring Boot æä¾›çš„ FilterRegistrationBean æ³¨å†Œ Filter ä½¿ç”¨åŸç”Ÿ Servlet æ³¨è§£ @WebFilter å®šä¹‰ Filter ä½¿ç”¨ FilterRegistrationBean æ³¨å†Œ Filter è‡ªå®šä¹‰ Filter å¹¶å®ç° jakarta.servlet.Filter ã€‚ï¼ˆä½ç‰ˆæœ¬ JDK è¯·ä½¿ç”¨ javax.servlet.Filterï¼‰ java Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import jakarta.servlet.Filter; import jakarta.servlet.FilterChain; import jakarta.servlet.ServletException; import jakarta.servlet.ServletRequest; import jakarta.servlet.ServletResponse; import java.io.IOException; public class MyFilter implements Filter { @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { // your code } } è‡ªå®šä¹‰é…ç½®ç±»é…ç½® Filter java Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import org.springframework.boot.web.servlet.FilterRegistrationBean; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; @Configuration public class WebConfig { @Bean public FilterRegistrationBean\u003cMyFilter\u003e myFilterFilterRegistration() { FilterRegistrationBean\u003cMyFilter\u003e registrationBean = new FilterRegistrationBean\u003c\u003e(); MyFilter myFilter = new MyFilter(); registrationBean.setFilter(myFilter); return registrationBean; } } ä½¿ç”¨åŸç”Ÿ Servlet æ³¨è§£ @WebFilter å®šä¹‰ Filter è‡ªå®šä¹‰ Filter å¹¶å®ç° jakarta.servlet.Filter ï¼ˆä½ç‰ˆæœ¬ JDK è¯·ä½¿ç”¨ javax.servlet.Filterï¼‰ï¼ŒåŒæ—¶æ·»åŠ  @WebFilter æ³¨è§£ã€‚ java Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import jakarta.servlet.Filter; import jakarta.servlet.FilterChain; import jakarta.servlet.ServletException; import jakarta.servlet.ServletRequest; import jakarta.servlet.ServletResponse; import jakarta.servlet.annotation.WebFilter; import java.io.IOException; @WebFilter public class MyFilter implements Filter { @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { // your code } } åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ  @ServletComponentScan æ³¨è§£ java Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.boot.web.servlet.ServletComponentScan; @SpringBootApplication @ServletComponentScan public class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); } } è‡ªå®šä¹‰è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº ä½¿ç”¨è‡ªå®šä¹‰é…ç½®ç±»é…ç½®è¿‡æ»¤å™¨æ—¶ï¼Œå¯é€šè¿‡ setOrder() æ–¹æ³•è®¾ç½®è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåºã€‚å¦‚ä¸è®¾ç½®ï¼Œåˆ™æŒ‰ç…§ Spring Boot Bean åŠ è½½é¡ºåºã€‚\nä½¿ç”¨ Servlet åŸç”Ÿæ³¨è§£ @WebFilter æ—¶ï¼Œåªèƒ½é€šè¿‡é™å®š Filter ç±»å‹ï¼ˆæŒ‰å­—æ¯è¡¨ A - Z çš„é¡ºåºï¼‰ã€‚æ³¨æ„ï¼šæ­¤æ–¹å¼ä½¿ç”¨ @Order æ³¨è§£æ— æ•ˆã€‚\nSpring Boot ä½¿ç”¨ Interceptor å½“è¯·æ±‚æ¥åˆ° DispatcherServlet æ—¶ï¼Œå®ƒä¼šæ ¹æ® HandlerMapping çš„æœºåˆ¶æ‰¾åˆ°å¤„ç†å™¨ï¼Œè¿™æ ·å°±ä¼šè¿”å›ä¸€ä¸ª HandlerExecutionChain å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«å¤„ç†å™¨å’Œæ‹¦æˆªå™¨ã€‚è¿™é‡Œçš„æ‹¦æˆªå™¨ä¼šå¯¹å¤„ç†å™¨è¿›è¡Œæ‹¦æˆªï¼Œè¿™æ ·é€šè¿‡æ‹¦æˆªå™¨å°±å¯ä»¥å¢å¼ºå¤„ç†å™¨çš„åŠŸèƒ½ã€‚ â€”â€”ã€Šæ·±å…¥æµ…å‡º Spring Boot 2.Xã€‹- æ¨å¼€æŒ¯\næ‹¦æˆªå™¨çš„è®¾è®¡ï¼ˆInterceptor æ¥å£ï¼‰ æ‰€æœ‰çš„æ‹¦æˆªå™¨éƒ½éœ€è¦å®ç° HandlerInterceptor æ¥å£ã€‚è¯¥æ¥å£ä¸»è¦å®šä¹‰å¦‚ä¸‹ï¼š\njava Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import jakarta.servlet.http.HttpServletRequest; import jakarta.servlet.http.HttpServletResponse; import org.springframework.lang.Nullable; public interface HandlerInterceptor { default boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { return true; } default void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, @Nullable ModelAndView modelAndView) throws Exception { } default void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, @Nullable Exception ex) throws Exception { } } è¿™äº›æ–¹æ³•çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š\næ‰§è¡Œ preHandler() æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœä¸º false ï¼Œåˆ™ç»“æŸæ‰€æœ‰æµç¨‹ï¼›å¦‚æœä¸º true ï¼Œåˆ™æ‰§è¡Œä¸‹ä¸€æ­¥ æ‰§è¡Œå¤„ç†å™¨é€»è¾‘ã€‚å®ƒåŒ…å«æ§åˆ¶å™¨çš„åŠŸèƒ½ã€‚ æ‰§è¡Œ postHandle() æ–¹æ³•ã€‚ æ‰§è¡Œè§†å›¾è§£æå’Œè§†å›¾æ¸²æŸ“ã€‚ æ‰§è¡Œ afterCompletion() æ–¹æ³•ã€‚ å¼€å‘æ‹¦æˆªå™¨ å®šä¹‰ç®€å•æ‹¦æˆªå™¨ å®ç° HandlerInterceptor æ¥å£ï¼Œå¹¶å®ç°å…¶æ–¹æ³•ï¼š\njava Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import jakarta.servlet.http.HttpServletRequest; import jakarta.servlet.http.HttpServletResponse; import org.springframework.web.servlet.HandlerInterceptor; import org.springframework.web.servlet.ModelAndView; public class MyInterceptor implements HandlerInterceptor { @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(\"å¤„ç†å™¨æ‰§è¡Œå‰æ–¹æ³•\"); return true; } @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(\"å¤„ç†å™¨æ‰§è¡Œåæ–¹æ³•\"); } @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(\"å¤„ç†å™¨å®Œæˆæ–¹æ³•\"); } } æ³¨å†Œæ‹¦æˆªå™¨ æ–°å»ºé…ç½®ç±»å¹¶å®ç° WebMvcConfigurer æ¥å£ï¼Œé‡å†™ addInterceptors(InterceptorRegistry registry) æ–¹æ³•ï¼š\njava Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 import org.springframework.context.annotation.Configuration; import org.springframework.web.servlet.config.annotation.InterceptorRegistry; import org.springframework.web.servlet.config.annotation.WebMvcConfigurer; @Configuration public class WebConfig implements WebMvcConfigurer { @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(new MyInterceptor()) .addPathPatterns(\"/test/*\"); } } å¤šä¸ªæ‹¦æˆªå™¨é¡ºåº å¤šä¸ªæ‹¦æˆªå™¨æ‹¦æˆªåŒä¸€è·¯å¾„æ—¶ï¼Œé‡‡ç”¨è´£ä»»é“¾æ¨¡å¼çš„è§„åˆ™ï¼Œå¯¹äºå¤„ç†å™¨å‰æ–¹æ³•é‡‡ç”¨å…ˆæ³¨å†Œå…ˆæ‰§è¡Œï¼Œè€Œå¤„ç†åæ–¹æ³•å’Œå®Œæˆæ–¹æ³•åˆ™æ˜¯å…ˆæ³¨å†Œåæ‰§è¡Œçš„è§„åˆ™ã€‚\nå½“å¤šä¸ªæ‹¦æˆªå™¨ä¸­æŸä¸€ä¸ªå¤„ç†å‰ï¼ˆpreHandle()ï¼‰æ–¹æ³•ä¸º false æ—¶ï¼Œåˆ™åç»­æ‹¦æˆªå™¨ã€å¤„ç†å™¨å’Œæ‰€æœ‰æ‹¦æˆªå™¨çš„å¤„ç†å™¨åï¼ˆ postHandle() ï¼‰æ–¹æ³•éƒ½ä¸ä¼šæ‰§è¡Œã€‚å®Œæˆæ–¹æ³•ï¼ˆ afterCompletion() ï¼‰åˆ™ä¸ä¸€æ ·ï¼Œå®ƒåªä¼šæ‰§è¡Œè¿”å› true çš„æ‹¦æˆªå™¨çš„å®Œæˆæ–¹æ³•ï¼Œè€Œä¸”é¡ºåºæ˜¯å…ˆæ³¨å†Œåæ‰§è¡Œã€‚\n","wordCount":"626","inLanguage":"zh","datePublished":"2024-05-07T14:14:08+08:00","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"tofuwine"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/"},"publisher":{"@type":"Organization","name":"Tofuwine's Blog","logo":{"@type":"ImageObject","url":"https://tofuwine.github.io/images/favicon.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tofuwine.github.io/ accesskey=h><img src=https://tofuwine.github.io/images/profile.png alt aria-label=logo height=35>Tofuwine's Blog</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://tofuwine.github.io/articles><span>ğŸ“ æ–‡ç« </span></a></li><li><a href=https://tofuwine.github.io/archives><span>ğŸ—‚ï¸ å½’æ¡£</span></a></li><li><a href=https://tofuwine.github.io/friend><span>ğŸ¤ å‹é“¾</span></a></li><li><a href=https://tofuwine.github.io/search accesskey=/><span>ğŸ” æœç´¢</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tofuwine.github.io/>ğŸ  ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://tofuwine.github.io/articles/>ğŸ“ æ–‡ç« </a>&nbsp;Â»&nbsp;<a href=https://tofuwine.github.io/articles/code/>ğŸ–¥ï¸ è®¡ç®—æœºç¼–ç¨‹æŠ€æœ¯</a></div><h1 class="post-title entry-hint-parent">Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„åŒºåˆ«ä¸ä½¿ç”¨</h1><div class=post-meta><span class=x-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>2024-02-27</span></span>&nbsp;Â·&nbsp;<span class=x-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>626 å­—</span></span>&nbsp;Â·&nbsp;<span class=x-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>3 åˆ†é’Ÿ</span></span>
<span class=x-post-meta-item>&nbsp;Â·&nbsp;<svg t="1714036239378" fill="currentcolor" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6659" width="256" height="256"><path d="M690 78.2c-18.6-18.8-49-19-67.8-.4s-19 49-.4 67.8l255.4 258.6c67.8 68.6 67.8 178.8.0 247.4L653.4 878.2c-18.6 18.8-18.4 49.2.4 67.8s49.2 18.4 67.8-.4l224-226.4c104.8-106 104.8-276.4.0-382.4L690 78.2zM485.4 101.4c-24-24-56.6-37.4-90.6-37.4H96C43 64 0 107 0 160v299c0 34 13.4 66.6 37.4 90.6l336 336c50 50 131 50 181 0l267-267c50-50 50-131 0-181l-336-336zM96 160h299c8.4.0 16.6 3.4 22.6 9.4l336 336c12.4 12.4 12.4 32.8.0 45.2l-267 267c-12.4 12.4-32.8 12.4-45.2.0l-336-336c-6-6-9.4-14.2-9.4-22.6V160zm192 128a64 64 0 10-128 0 64 64 0 10128 0z" p-id="6660"/></svg></span><ul class=x-post-meta-item><a href=https://tofuwine.github.io/tags/spring/>#Spring</a></ul></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#spring-%e6%8b%a6%e6%88%aa%e5%99%a8%e4%b8%8e-servlet-filter-%e7%9a%84%e5%bc%82%e5%90%8c aria-label="Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„å¼‚åŒ">Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„å¼‚åŒ</a><ul><li><a href=#%e4%bd%95%e6%97%b6%e4%bd%bf%e7%94%a8-filterinterceptor aria-label="ä½•æ—¶ä½¿ç”¨ Filterã€Interceptorï¼Ÿ">ä½•æ—¶ä½¿ç”¨ Filterã€Interceptorï¼Ÿ</a></ul><li><a href=#spring-boot-%e4%bd%bf%e7%94%a8-filter aria-label="Spring Boot ä½¿ç”¨ Filter">Spring Boot ä½¿ç”¨ Filter</a><ul><li><a href=#%e4%bd%bf%e7%94%a8-filterregistrationbean-%e6%b3%a8%e5%86%8c-filter aria-label="ä½¿ç”¨ FilterRegistrationBean æ³¨å†Œ Filter">ä½¿ç”¨ <code>FilterRegistrationBean</code> æ³¨å†Œ Filter</a><li><a href=#%e4%bd%bf%e7%94%a8%e5%8e%9f%e7%94%9f-servlet-%e6%b3%a8%e8%a7%a3-webfilter-%e5%ae%9a%e4%b9%89-filter aria-label="ä½¿ç”¨åŸç”Ÿ Servlet æ³¨è§£ @WebFilter å®šä¹‰ Filter">ä½¿ç”¨åŸç”Ÿ Servlet æ³¨è§£ <code>@WebFilter</code> å®šä¹‰ Filter</a><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e8%bf%87%e6%bb%a4%e5%99%a8%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f aria-label=è‡ªå®šä¹‰è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº>è‡ªå®šä¹‰è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº</a></ul><li><a href=#spring-boot-%e4%bd%bf%e7%94%a8-interceptor aria-label="Spring Boot ä½¿ç”¨ Interceptor">Spring Boot ä½¿ç”¨ Interceptor</a><ul><li><a href=#%e6%8b%a6%e6%88%aa%e5%99%a8%e7%9a%84%e8%ae%be%e8%ae%a1interceptor-%e6%8e%a5%e5%8f%a3 aria-label="æ‹¦æˆªå™¨çš„è®¾è®¡ï¼ˆInterceptor æ¥å£ï¼‰">æ‹¦æˆªå™¨çš„è®¾è®¡ï¼ˆInterceptor æ¥å£ï¼‰</a><li><a href=#%e5%bc%80%e5%8f%91%e6%8b%a6%e6%88%aa%e5%99%a8 aria-label=å¼€å‘æ‹¦æˆªå™¨>å¼€å‘æ‹¦æˆªå™¨</a><ul><li><a href=#%e5%ae%9a%e4%b9%89%e7%ae%80%e5%8d%95%e6%8b%a6%e6%88%aa%e5%99%a8 aria-label=å®šä¹‰ç®€å•æ‹¦æˆªå™¨>å®šä¹‰ç®€å•æ‹¦æˆªå™¨</a><li><a href=#%e6%b3%a8%e5%86%8c%e6%8b%a6%e6%88%aa%e5%99%a8 aria-label=æ³¨å†Œæ‹¦æˆªå™¨>æ³¨å†Œæ‹¦æˆªå™¨</a><li><a href=#%e5%a4%9a%e4%b8%aa%e6%8b%a6%e6%88%aa%e5%99%a8%e9%a1%ba%e5%ba%8f aria-label=å¤šä¸ªæ‹¦æˆªå™¨é¡ºåº>å¤šä¸ªæ‹¦æˆªå™¨é¡ºåº</a></li></div></details></div></aside><script>let activeElement,elements=[];window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).parentElement.classList.add("tw-toc-active","tw-toc-open")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.scrollY>0&&getOffsetTop(e)-window.scrollY<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const n=encodeURI(e.getAttribute("id")).toLowerCase(),t=document.querySelector(`.inner ul li a[href="#${n}"]`).parentElement;e===activeElement?(t.classList.add("tw-toc-active","tw-toc-open"),getAllLIParents(t).forEach(e=>e.classList.add("tw-toc-open"))):t.classList.remove("tw-toc-active","tw-toc-open")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}function getAllLIParents(e){let n=[],t=e.parentNode;for(;t!==null;)t.tagName==="LI"&&n.push(t),t=t.parentNode;return n}</script><div class=post-content><blockquote><p>æ–‡ä¸­ä»£ç åŸºäº Java 17</p></blockquote><h2 id=spring-æ‹¦æˆªå™¨ä¸-servlet-filter-çš„å¼‚åŒ>Spring æ‹¦æˆªå™¨ä¸ Servlet Filter çš„å¼‚åŒ<a hidden class=anchor aria-hidden=true href=#spring-æ‹¦æˆªå™¨ä¸-servlet-filter-çš„å¼‚åŒ>#</a></h2><p>Spring çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰ä¸ Servlet çš„ Filter æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œæ¯”å¦‚äºŒè€…éƒ½æ˜¯ AOP ç¼–ç¨‹æ€æƒ³çš„ä½“ç°ï¼Œéƒ½èƒ½å®ç°æƒé™æ£€æŸ¥ã€æ—¥å¿—è®°å½•ç­‰ã€‚</p><p>ä¸åŒçš„æ˜¯ï¼š</p><ul><li>ä½¿ç”¨èŒƒå›´ä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒè§„å®šçš„ï¼Œåªèƒ½ç”¨äº Web ç¨‹åºä¸­ã€‚è€Œæ‹¦æˆªå™¨æ—¢å¯ä»¥ç”¨äº Web ç¨‹åºï¼Œä¹Ÿå¯ä»¥ç”¨äº Applicationã€Swing ç­‰ç¨‹åºä¸­ã€‚</li><li>è§„èŒƒä¸åŒï¼šFilter æ˜¯ Servlet è§„èŒƒä¸­å®šä¹‰çš„ï¼Œæ˜¯ Servlet å®¹å™¨æ”¯æŒçš„ã€‚è€Œæ‹¦æˆªå™¨æ˜¯åœ¨ Spring å®¹å™¨å†…çš„ï¼Œæ˜¯ Spring æ¡†æ¶æ”¯æŒçš„ã€‚</li><li>ä½¿ç”¨èµ„æºä¸åŒï¼šåŒå…¶ä»–ä»£ç å—ä¸€æ ·ï¼ŒInterceptor ä¹Ÿæ˜¯ä¸€ä¸ª Spring çš„ç»„ä»¶ï¼Œå½’ Spring ç®¡ç†ï¼Œé…ç½®åœ¨ Spring æ–‡ä»¶ä¸­ï¼Œå› æ­¤èƒ½ä½¿ç”¨ Spring é‡Œçš„ä»»ä½•èµ„æºã€å¯¹è±¡ï¼Œä¾‹å¦‚ Service å¯¹è±¡ã€æ•°æ®æºã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œé€šè¿‡ IoC æ³¨å…¥æ‹¦æˆªå™¨å³å¯ã€‚è€Œ Filter åˆ™ä¸èƒ½ã€‚</li><li>æ·±åº¦ä¸åŒï¼šFilter åªåœ¨ Servlet å‰åèµ·ä½œç”¨ã€‚è€Œæ‹¦æˆªå™¨èƒ½å¤Ÿæ·±å…¥åˆ°æ–¹æ³•å‰åã€å¼‚å¸¸æŠ›å‡ºå‰åç­‰ã€‚å› æ­¤æ‹¦æˆªå™¨çš„ä½¿ç”¨å…·æœ‰æ›´å¤§çš„å¼¹æ€§ã€‚æ‰€ä»¥åœ¨ Spring æ¶æ„çš„ç¨‹åºä¸­ï¼Œè¦ä¼˜å…ˆä½¿ç”¨æ‹¦æˆªå™¨ã€‚</li></ul><p>å¯¹äºä¸€ä¸ªè¯·æ±‚ï¼Œæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p><pre class=mermaid>flowchart LR
  A((request))
  B(Filter)
  C(Servlet)
  D(Interceptor)
  E(Controller)
  F((doService))
  
  A --> B --> C --> D --> E --> F
</pre><h3 id=ä½•æ—¶ä½¿ç”¨-filterinterceptor>ä½•æ—¶ä½¿ç”¨ Filterã€Interceptorï¼Ÿ<a hidden class=anchor aria-hidden=true href=#ä½•æ—¶ä½¿ç”¨-filterinterceptor>#</a></h3><ul><li>å¦‚æœæ˜¯é Spring é¡¹ç›®ï¼Œé‚£ä¹ˆæ‹¦æˆªå™¨ä¸èƒ½ç”¨ï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚</li><li>å¦‚æœæ˜¯å¤„ç† <code>Controller</code> å‰åï¼Œæ—¢å¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨ã€‚</li><li>å¦‚æœæ˜¯å¤„ç† <code>DispatcherServlet</code> å‰åï¼Œåªèƒ½ä½¿ç”¨è¿‡æ»¤å™¨ã€‚</li></ul><h2 id=spring-boot-ä½¿ç”¨-filter>Spring Boot ä½¿ç”¨ Filter<a hidden class=anchor aria-hidden=true href=#spring-boot-ä½¿ç”¨-filter>#</a></h2><p>Spring Boot ä½¿ç”¨ Filter æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>ä½¿ç”¨ Spring Boot æä¾›çš„ <code>FilterRegistrationBean</code> æ³¨å†Œ Filter</li><li>ä½¿ç”¨åŸç”Ÿ Servlet æ³¨è§£ <code>@WebFilter</code> å®šä¹‰ Filter</li></ul><h3 id=ä½¿ç”¨-filterregistrationbean-æ³¨å†Œ-filter>ä½¿ç”¨ <code>FilterRegistrationBean</code> æ³¨å†Œ Filter<a hidden class=anchor aria-hidden=true href=#ä½¿ç”¨-filterregistrationbean-æ³¨å†Œ-filter>#</a></h3><ol><li>è‡ªå®šä¹‰ Filter å¹¶å®ç° <code>jakarta.servlet.Filter</code> ã€‚ï¼ˆä½ç‰ˆæœ¬ JDK è¯·ä½¿ç”¨ <code>javax.servlet.Filter</code>ï¼‰</li></ol><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.Filter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.FilterChain</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.io.IOException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyFilter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Filter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>doFilter</span><span class=p>(</span><span class=n>ServletRequest</span><span class=w> </span><span class=n>servletRequest</span><span class=p>,</span><span class=w> </span><span class=n>ServletResponse</span><span class=w> </span><span class=n>servletResponse</span><span class=p>,</span><span class=w> </span><span class=n>FilterChain</span><span class=w> </span><span class=n>filterChain</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=p>,</span><span class=w> </span><span class=n>ServletException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// your code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><ol start=2><li>è‡ªå®šä¹‰é…ç½®ç±»é…ç½® Filter</li></ol><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.web.servlet.FilterRegistrationBean</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Bean</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Configuration</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>WebConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>FilterRegistrationBean</span><span class=o>&lt;</span><span class=n>MyFilter</span><span class=o>&gt;</span><span class=w> </span><span class=nf>myFilterFilterRegistration</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>FilterRegistrationBean</span><span class=o>&lt;</span><span class=n>MyFilter</span><span class=o>&gt;</span><span class=w> </span><span class=n>registrationBean</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>FilterRegistrationBean</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>MyFilter</span><span class=w> </span><span class=n>myFilter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MyFilter</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>registrationBean</span><span class=p>.</span><span class=na>setFilter</span><span class=p>(</span><span class=n>myFilter</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>registrationBean</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=ä½¿ç”¨åŸç”Ÿ-servlet-æ³¨è§£-webfilter-å®šä¹‰-filter>ä½¿ç”¨åŸç”Ÿ Servlet æ³¨è§£ <code>@WebFilter</code> å®šä¹‰ Filter<a hidden class=anchor aria-hidden=true href=#ä½¿ç”¨åŸç”Ÿ-servlet-æ³¨è§£-webfilter-å®šä¹‰-filter>#</a></h3><ol><li>è‡ªå®šä¹‰ Filter å¹¶å®ç° <code>jakarta.servlet.Filter</code> ï¼ˆä½ç‰ˆæœ¬ JDK è¯·ä½¿ç”¨ <code>javax.servlet.Filter</code>ï¼‰ï¼ŒåŒæ—¶æ·»åŠ  <code>@WebFilter</code> æ³¨è§£ã€‚</li></ol><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.Filter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.FilterChain</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.annotation.WebFilter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.io.IOException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@WebFilter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyFilter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Filter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>doFilter</span><span class=p>(</span><span class=n>ServletRequest</span><span class=w> </span><span class=n>servletRequest</span><span class=p>,</span><span class=w> </span><span class=n>ServletResponse</span><span class=w> </span><span class=n>servletResponse</span><span class=p>,</span><span class=w> </span><span class=n>FilterChain</span><span class=w> </span><span class=n>filterChain</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=p>,</span><span class=w> </span><span class=n>ServletException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// your code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><ol start=2><li>åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ  <code>@ServletComponentScan</code> æ³¨è§£</li></ol><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.SpringApplication</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.autoconfigure.SpringBootApplication</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.web.servlet.ServletComponentScan</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@SpringBootApplication</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@ServletComponentScan</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Application</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SpringApplication</span><span class=p>.</span><span class=na>run</span><span class=p>(</span><span class=n>Application</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=è‡ªå®šä¹‰è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº>è‡ªå®šä¹‰è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº<a hidden class=anchor aria-hidden=true href=#è‡ªå®šä¹‰è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº>#</a></h3><p>ä½¿ç”¨è‡ªå®šä¹‰é…ç½®ç±»é…ç½®è¿‡æ»¤å™¨æ—¶ï¼Œå¯é€šè¿‡ <code>setOrder()</code> æ–¹æ³•è®¾ç½®è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåºã€‚å¦‚ä¸è®¾ç½®ï¼Œåˆ™æŒ‰ç…§ Spring Boot Bean åŠ è½½é¡ºåºã€‚</p><p>ä½¿ç”¨ Servlet åŸç”Ÿæ³¨è§£ <code>@WebFilter</code> æ—¶ï¼Œåªèƒ½é€šè¿‡é™å®š Filter ç±»å‹ï¼ˆæŒ‰å­—æ¯è¡¨ A - Z çš„é¡ºåºï¼‰ã€‚æ³¨æ„ï¼šæ­¤æ–¹å¼ä½¿ç”¨ <code>@Order</code> æ³¨è§£æ— æ•ˆã€‚</p><h2 id=spring-boot-ä½¿ç”¨-interceptor>Spring Boot ä½¿ç”¨ Interceptor<a hidden class=anchor aria-hidden=true href=#spring-boot-ä½¿ç”¨-interceptor>#</a></h2><blockquote><p>å½“è¯·æ±‚æ¥åˆ° <code>DispatcherServlet</code> æ—¶ï¼Œå®ƒä¼šæ ¹æ® <code>HandlerMapping</code> çš„æœºåˆ¶æ‰¾åˆ°å¤„ç†å™¨ï¼Œè¿™æ ·å°±ä¼šè¿”å›ä¸€ä¸ª <code>HandlerExecutionChain</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«å¤„ç†å™¨å’Œæ‹¦æˆªå™¨ã€‚è¿™é‡Œçš„æ‹¦æˆªå™¨ä¼šå¯¹å¤„ç†å™¨è¿›è¡Œæ‹¦æˆªï¼Œè¿™æ ·é€šè¿‡æ‹¦æˆªå™¨å°±å¯ä»¥å¢å¼ºå¤„ç†å™¨çš„åŠŸèƒ½ã€‚ â€”â€”ã€Šæ·±å…¥æµ…å‡º Spring Boot 2.Xã€‹- æ¨å¼€æŒ¯</p></blockquote><h3 id=æ‹¦æˆªå™¨çš„è®¾è®¡interceptor-æ¥å£>æ‹¦æˆªå™¨çš„è®¾è®¡ï¼ˆInterceptor æ¥å£ï¼‰<a hidden class=anchor aria-hidden=true href=#æ‹¦æˆªå™¨çš„è®¾è®¡interceptor-æ¥å£>#</a></h3><p>æ‰€æœ‰çš„æ‹¦æˆªå™¨éƒ½éœ€è¦å®ç° <code>HandlerInterceptor</code> æ¥å£ã€‚è¯¥æ¥å£ä¸»è¦å®šä¹‰å¦‚ä¸‹ï¼š</p><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.http.HttpServletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.http.HttpServletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.lang.Nullable</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>HandlerInterceptor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>default</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>preHandle</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>default</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>postHandle</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>,</span><span class=w> </span><span class=nd>@Nullable</span><span class=w> </span><span class=n>ModelAndView</span><span class=w> </span><span class=n>modelAndView</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>default</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>afterCompletion</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>,</span><span class=w> </span><span class=nd>@Nullable</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><p>è¿™äº›æ–¹æ³•çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>æ‰§è¡Œ <code>preHandler()</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœä¸º <code>false</code> ï¼Œåˆ™ç»“æŸæ‰€æœ‰æµç¨‹ï¼›å¦‚æœä¸º <code>true</code> ï¼Œåˆ™æ‰§è¡Œä¸‹ä¸€æ­¥</li><li>æ‰§è¡Œå¤„ç†å™¨é€»è¾‘ã€‚å®ƒåŒ…å«æ§åˆ¶å™¨çš„åŠŸèƒ½ã€‚</li><li>æ‰§è¡Œ <code>postHandle()</code> æ–¹æ³•ã€‚</li><li>æ‰§è¡Œè§†å›¾è§£æå’Œè§†å›¾æ¸²æŸ“ã€‚</li><li>æ‰§è¡Œ <code>afterCompletion()</code> æ–¹æ³•ã€‚</li></ol><h3 id=å¼€å‘æ‹¦æˆªå™¨>å¼€å‘æ‹¦æˆªå™¨<a hidden class=anchor aria-hidden=true href=#å¼€å‘æ‹¦æˆªå™¨>#</a></h3><h4 id=å®šä¹‰ç®€å•æ‹¦æˆªå™¨>å®šä¹‰ç®€å•æ‹¦æˆªå™¨<a hidden class=anchor aria-hidden=true href=#å®šä¹‰ç®€å•æ‹¦æˆªå™¨>#</a></h4><p>å®ç° <code>HandlerInterceptor</code> æ¥å£ï¼Œå¹¶å®ç°å…¶æ–¹æ³•ï¼š</p><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.http.HttpServletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.http.HttpServletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.servlet.HandlerInterceptor</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.servlet.ModelAndView</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyInterceptor</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>HandlerInterceptor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>preHandle</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;å¤„ç†å™¨æ‰§è¡Œå‰æ–¹æ³•&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>postHandle</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>,</span><span class=w> </span><span class=n>ModelAndView</span><span class=w> </span><span class=n>modelAndView</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;å¤„ç†å™¨æ‰§è¡Œåæ–¹æ³•&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>afterCompletion</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>,</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;å¤„ç†å™¨å®Œæˆæ–¹æ³•&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h4 id=æ³¨å†Œæ‹¦æˆªå™¨>æ³¨å†Œæ‹¦æˆªå™¨<a hidden class=anchor aria-hidden=true href=#æ³¨å†Œæ‹¦æˆªå™¨>#</a></h4><p>æ–°å»ºé…ç½®ç±»å¹¶å®ç° <code>WebMvcConfigurer</code> æ¥å£ï¼Œé‡å†™ <code>addInterceptors(InterceptorRegistry registry)</code> æ–¹æ³•ï¼š</p><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Configuration</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.servlet.config.annotation.InterceptorRegistry</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.servlet.config.annotation.WebMvcConfigurer</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>WebConfig</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>WebMvcConfigurer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>addInterceptors</span><span class=p>(</span><span class=n>InterceptorRegistry</span><span class=w> </span><span class=n>registry</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>registry</span><span class=p>.</span><span class=na>addInterceptor</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>MyInterceptor</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>addPathPatterns</span><span class=p>(</span><span class=s>&#34;/test/*&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h4 id=å¤šä¸ªæ‹¦æˆªå™¨é¡ºåº>å¤šä¸ªæ‹¦æˆªå™¨é¡ºåº<a hidden class=anchor aria-hidden=true href=#å¤šä¸ªæ‹¦æˆªå™¨é¡ºåº>#</a></h4><p>å¤šä¸ªæ‹¦æˆªå™¨æ‹¦æˆªåŒä¸€è·¯å¾„æ—¶ï¼Œé‡‡ç”¨è´£ä»»é“¾æ¨¡å¼çš„è§„åˆ™ï¼Œå¯¹äºå¤„ç†å™¨å‰æ–¹æ³•é‡‡ç”¨<strong>å…ˆæ³¨å†Œå…ˆæ‰§è¡Œ</strong>ï¼Œè€Œå¤„ç†åæ–¹æ³•å’Œå®Œæˆæ–¹æ³•åˆ™æ˜¯<strong>å…ˆæ³¨å†Œåæ‰§è¡Œ</strong>çš„è§„åˆ™ã€‚</p><blockquote><p>å½“å¤šä¸ªæ‹¦æˆªå™¨ä¸­æŸä¸€ä¸ªå¤„ç†å‰ï¼ˆ<code>preHandle()</code>ï¼‰æ–¹æ³•ä¸º <code>false</code> æ—¶ï¼Œåˆ™åç»­æ‹¦æˆªå™¨ã€å¤„ç†å™¨å’Œæ‰€æœ‰æ‹¦æˆªå™¨çš„å¤„ç†å™¨åï¼ˆ <code>postHandle()</code> ï¼‰æ–¹æ³•éƒ½ä¸ä¼šæ‰§è¡Œã€‚å®Œæˆæ–¹æ³•ï¼ˆ <code>afterCompletion()</code> ï¼‰åˆ™ä¸ä¸€æ ·ï¼Œå®ƒåªä¼šæ‰§è¡Œè¿”å› <code>true</code> çš„æ‹¦æˆªå™¨çš„å®Œæˆæ–¹æ³•ï¼Œè€Œä¸”é¡ºåºæ˜¯<strong>å…ˆæ³¨å†Œåæ‰§è¡Œ</strong>ã€‚</p></blockquote></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div class=tw-reward-button><a href=javascript:void(0); onclick='document.getElementById("tw-qr-overlay").style.display="block"'>èµèµ</a></div><div id=tw-qr-overlay style=display:none><div class=tw-qr><div id=wechat class=tw-qrcode><a class=fancybox rel=group><img id=wechat_qr src=https://tofuwine.github.io/images/wechat_pay.jpg alt=wechat_pay></a><p>å¾®ä¿¡</p></div><div id=alipay class=tw-qrcode><a class=fancybox rel=group><img id=alipay_qr src=https://tofuwine.github.io/images/alipay.jpg alt=alipay></a><p>æ”¯ä»˜å®</p></div></div></div><p>å¦‚æœæœ¬æ–‡å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¯ä»¥ç‚¹å‡»ä¸Šæ–¹èµèµæŒ‰é’®è¯·ä½œè€…å–æ¯å’–å•¡ï¼</p></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://tofuwine.github.io/tags/spring/>Spring</a></li></ul><nav class=paginav><a class=prev href=https://tofuwine.github.io/articles/code/z/28095def-16f4-4aab-a023-8937447fa34f/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>FreeMarker åŸºæœ¬ç”¨æ³•</span></a></nav></footer><div class=comments-title id=comment><p class=x-comments-title>æ¬¢è¿æ¥åˆ°è¯„è®ºåŒº</p><p style=font-size:1rem>æ„Ÿè°¢æ‚¨çš„è€å¿ƒé˜…è¯»ï¼æ¥é€‰ä¸ªè¡¨æƒ…ï¼Œæˆ–è€…ç•™ä¸ªè¯„è®ºå§ï¼</p></div><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"tofuwine/tofuwine.github.io","data-repo-id":"R_kgDOLz45lw","data-category":"Announcements","data-category-id":"DIC_kwDOLz45l84CfBDJ","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":getStoredTheme(),"data-lang":"zh-CN","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2024 <a href=https://tofuwine.github.io/>Tofuwine's Blog</a> All Rights Reserved</span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" class=top-link id=top-link accesskey=g><span class=tw-top-inner><svg class="tw-top-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
<span id=tw-read-progress></span>
</span></a><script>let detail=document.getElementsByClassName("details");details=[].slice.call(detail);for(let e=0;e<details.length;e++){let t=details[e];const n=t.getElementsByClassName("details-summary")[0];n&&n.addEventListener("click",()=>{t.classList.toggle("open")},!1)}</script><a href=#comment aria-label="go to bottom comment" class="top-link bottom-comment" id=bottom-comment accesskey=b style=visibility:visible;opacity:1><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29.338 29.338" fill="currentcolor"><path d="M27.184 1.605H2.156C.967 1.605.0 2.572.0 3.76v17.572c0 1.188.967 2.155 2.156 2.155h13.543l5.057 3.777c.414.31.842.468 1.268.468.789.0 1.639-.602 1.637-1.923v-2.322h3.523c1.188.0 2.154-.967 2.154-2.155V3.76C29.338 2.572 28.371 1.605 27.184 1.605zM27.34 21.332c0 .085-.068.155-.154.155h-5.523v3.955l-5.297-3.956H2.156c-.086.0-.154-.07-.154-.155V3.759c0-.085.068-.155.154-.155v.001h25.029c.086.0.154.07.154.155L27.34 21.332zM5.505 10.792h4.334v4.333H5.505V10.792zm7 0h4.334v4.333h-4.334V10.792zm7 0h4.334v4.333h-4.334V10.792z"/></svg>
</a><script>let comment=document.getElementById("comment"),bottomToComment=document.getElementById("bottom-comment");document.addEventListener("scroll",function(){const e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t=comment.offsetTop,n=document.documentElement.scrollTop,s=t-n;s<=e+100?(bottomToComment.style.visibility="hidden",bottomToComment.style.opacity="0"):(bottomToComment.style.visibility="visible",bottomToComment.style.opacity="1")})</script><button id=theme-toggle-float accesskey=t class="top-link theme-toggle-float" style=visibility:visible;opacity:1>
<svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="3 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="3 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
<script>document.getElementById("theme-toggle-float").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>const goTopButton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(goTopButton.style.visibility="visible",goTopButton.style.opacity="1"):(goTopButton.style.visibility="hidden",goTopButton.style.opacity="0")},document.addEventListener("scroll",function(){const s=document.getElementById("tw-read-progress"),o=document.documentElement.scrollHeight,i=document.documentElement.clientHeight,t=document.documentElement.scrollTop||document.body.scrollTop,n=((t/(o-i)).toFixed(2)*100).toFixed(0);s.innerText=n,n==="100"&&(document.body.classList.add("tw-bottom-jump"),setTimeout(function(){document.body.classList.remove("tw-bottom-jump")},500)),t===0&&(document.body.classList.add("tw-top-jump"),setTimeout(function(){document.body.classList.remove("tw-top-jump")},500))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.closest(".tw-code-block-container"),t=s.querySelector("button");function n(){t.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.0633 5.67375C18.5196 5.98487 18.6374 6.607 18.3262 7.06331L10.8262 18.0633C10.6585 18.3093 10.3898 18.4678 10.0934 18.4956C9.79688 18.5234 9.50345 18.4176 9.29289 18.2071L4.79289 13.7071C4.40237 13.3166 4.40237 12.6834 4.79289 12.2929C5.18342 11.9023 5.81658 11.9023 6.20711 12.2929L9.85368 15.9394L16.6738 5.93664C16.9849 5.48033 17.607 5.36263 18.0633 5.67375Z" fill="currentColor"></path></svg>Copiedï¼',setTimeout(()=>{t.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentColor"></path></svg>Copy code'},2e3)}t.addEventListener("click",t=>{if(t.stopPropagation(),"clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)})})</script><script>window.onclick=function(e){const t=document.getElementById("tw-qr-overlay");e.target===t&&(t.style.display="none")}</script><script>let twCodeDetail=document.getElementsByClassName("tw-code-details");twCodeDetails=[].slice.call(twCodeDetail);for(let e=0;e<twCodeDetails.length;e++){let t=twCodeDetails[e];const n=t.getElementsByClassName("tw-code-details-summary")[0];n&&n.addEventListener("click",()=>{t.classList.toggle("open")},!1)}</script></body></html>