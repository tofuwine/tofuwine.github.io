<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Spring 拦截器与 Servlet Filter 的区别与使用 | Tofuwine's Blog</title>
<meta name=keywords content><meta name=description content="文中代码基于 Java 17
Spring 拦截器与 Servlet Filter 的异同 Spring 的拦截器（Interceptor）与 Servlet 的 Filter 有相似之处，比如二者都是 AOP 编程思想的体现，都能实现权限检查、日志记录等。
不同的是：
使用范围不同：Filter 是 Servlet 规范规定的，只能用于 Web 程序中。而拦截器既可以用于 Web 程序，也可以用于 Application、Swing 等程序中。 规范不同：Filter 是 Servlet 规范中定义的，是 Servlet 容器支持的。而拦截器是在 Spring 容器内的，是 Spring 框架支持的。 使用资源不同：同其他代码块一样，Interceptor 也是一个 Spring 的组件，归 Spring 管理，配置在 Spring 文件中，因此能使用 Spring 里的任何资源、对象，例如 Service 对象、数据源、事务管理等，通过 IoC 注入拦截器即可。而 Filter 则不能。 深度不同：Filter 只在 Servlet 前后起作用。而拦截器能够深入到方法前后、异常抛出前后等。因此拦截器的使用具有更大的弹性。所以在 Spring 架构的程序中，要优先使用拦截器。 对于一个请求，拦截器、过滤器执行流程如下：
flowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --> B --> C --> D --> E --> F 何时使用 Filter、Interceptor？ 如果是非 Spring 项目，那么拦截器不能用，只能使用过滤器。 如果是处理 Controller 前后，既可以使用拦截器也可以使用过滤器。 如果是处理 DispatcherServlet 前后，只能使用过滤器。 Spring Boot 使用 Filter Spring Boot 使用 Filter 有两种方式："><meta name=author content="tofuwine"><link rel=canonical href=https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://tofuwine.github.io/images/favicon.svg><link rel=icon type=image/png sizes=16x16 href=https://tofuwine.github.io/images/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://tofuwine.github.io/images/favicon.svg><link rel=apple-touch-icon href=https://tofuwine.github.io/images/favicon.svg><link rel=mask-icon href=https://tofuwine.github.io/images/favicon.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".parent");e.forEach(function(e){e.addEventListener("click",function(){const e=this.querySelector(".sub-menu");e.classList.toggle("active")})})})</script><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/tofuwine/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/tofuwine/fancybox@3.5.7/dist/jquery.fancybox.min.js></script><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
</script><meta property="og:title" content="Spring 拦截器与 Servlet Filter 的区别与使用"><meta property="og:description" content="文中代码基于 Java 17
Spring 拦截器与 Servlet Filter 的异同 Spring 的拦截器（Interceptor）与 Servlet 的 Filter 有相似之处，比如二者都是 AOP 编程思想的体现，都能实现权限检查、日志记录等。
不同的是：
使用范围不同：Filter 是 Servlet 规范规定的，只能用于 Web 程序中。而拦截器既可以用于 Web 程序，也可以用于 Application、Swing 等程序中。 规范不同：Filter 是 Servlet 规范中定义的，是 Servlet 容器支持的。而拦截器是在 Spring 容器内的，是 Spring 框架支持的。 使用资源不同：同其他代码块一样，Interceptor 也是一个 Spring 的组件，归 Spring 管理，配置在 Spring 文件中，因此能使用 Spring 里的任何资源、对象，例如 Service 对象、数据源、事务管理等，通过 IoC 注入拦截器即可。而 Filter 则不能。 深度不同：Filter 只在 Servlet 前后起作用。而拦截器能够深入到方法前后、异常抛出前后等。因此拦截器的使用具有更大的弹性。所以在 Spring 架构的程序中，要优先使用拦截器。 对于一个请求，拦截器、过滤器执行流程如下：
flowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --> B --> C --> D --> E --> F 何时使用 Filter、Interceptor？ 如果是非 Spring 项目，那么拦截器不能用，只能使用过滤器。 如果是处理 Controller 前后，既可以使用拦截器也可以使用过滤器。 如果是处理 DispatcherServlet 前后，只能使用过滤器。 Spring Boot 使用 Filter Spring Boot 使用 Filter 有两种方式："><meta property="og:type" content="article"><meta property="og:url" content="https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/"><meta property="article:section" content="articles"><meta property="article:published_time" content="2024-05-07T14:14:08+08:00"><meta property="og:site_name" content="Tofuwine's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spring 拦截器与 Servlet Filter 的区别与使用"><meta name=twitter:description content="文中代码基于 Java 17
Spring 拦截器与 Servlet Filter 的异同 Spring 的拦截器（Interceptor）与 Servlet 的 Filter 有相似之处，比如二者都是 AOP 编程思想的体现，都能实现权限检查、日志记录等。
不同的是：
使用范围不同：Filter 是 Servlet 规范规定的，只能用于 Web 程序中。而拦截器既可以用于 Web 程序，也可以用于 Application、Swing 等程序中。 规范不同：Filter 是 Servlet 规范中定义的，是 Servlet 容器支持的。而拦截器是在 Spring 容器内的，是 Spring 框架支持的。 使用资源不同：同其他代码块一样，Interceptor 也是一个 Spring 的组件，归 Spring 管理，配置在 Spring 文件中，因此能使用 Spring 里的任何资源、对象，例如 Service 对象、数据源、事务管理等，通过 IoC 注入拦截器即可。而 Filter 则不能。 深度不同：Filter 只在 Servlet 前后起作用。而拦截器能够深入到方法前后、异常抛出前后等。因此拦截器的使用具有更大的弹性。所以在 Spring 架构的程序中，要优先使用拦截器。 对于一个请求，拦截器、过滤器执行流程如下：
flowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --> B --> C --> D --> E --> F 何时使用 Filter、Interceptor？ 如果是非 Spring 项目，那么拦截器不能用，只能使用过滤器。 如果是处理 Controller 前后，既可以使用拦截器也可以使用过滤器。 如果是处理 DispatcherServlet 前后，只能使用过滤器。 Spring Boot 使用 Filter Spring Boot 使用 Filter 有两种方式："><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"📝 文章","item":"https://tofuwine.github.io/articles/"},{"@type":"ListItem","position":2,"name":"🖥️ 计算机编程技术","item":"https://tofuwine.github.io/articles/code/"},{"@type":"ListItem","position":3,"name":"Spring 拦截器与 Servlet Filter 的区别与使用","item":"https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spring 拦截器与 Servlet Filter 的区别与使用","name":"Spring 拦截器与 Servlet Filter 的区别与使用","description":"文中代码基于 Java 17 Spring 拦截器与 Servlet Filter 的异同 Spring 的拦截器（Interceptor）与 Servlet 的 Filter 有相似之处，比如二者都是 AOP 编程思想的体现，都能实现权限检查、日志记录等。 不同的是： 使用范围不同：Filter 是 Servlet 规范规定的，只能用于 Web 程序中。而拦截器既可以用于 Web 程序，也可以用于 Application、Swing 等程序中。 规范不同：Filter 是 Servlet 规范中定义的，是 Servlet 容器支持的。而拦截器是在 Spring 容器内的，是 Spring 框架支持的。 使用资源不同：同其他代码块一样，Interceptor 也是一个 Spring 的组件，归 Spring 管理，配置在 Spring 文件中，因此能使用 Spring 里的任何资源、对象，例如 Service 对象、数据源、事务管理等，通过 IoC 注入拦截器即可。而 Filter 则不能。 深度不同：Filter 只在 Servlet 前后起作用。而拦截器能够深入到方法前后、异常抛出前后等。因此拦截器的使用具有更大的弹性。所以在 Spring 架构的程序中，要优先使用拦截器。 对于一个请求，拦截器、过滤器执行流程如下： flowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --\u003e B --\u003e C --\u003e D --\u003e E --\u003e F 何时使用 Filter、Interceptor？ 如果是非 Spring 项目，那么拦截器不能用，只能使用过滤器。 如果是处理 Controller 前后，既可以使用拦截器也可以使用过滤器。 如果是处理 DispatcherServlet 前后，只能使用过滤器。 Spring Boot 使用 Filter Spring Boot 使用 Filter 有两种方式：","keywords":[""],"articleBody":" 文中代码基于 Java 17\nSpring 拦截器与 Servlet Filter 的异同 Spring 的拦截器（Interceptor）与 Servlet 的 Filter 有相似之处，比如二者都是 AOP 编程思想的体现，都能实现权限检查、日志记录等。\n不同的是：\n使用范围不同：Filter 是 Servlet 规范规定的，只能用于 Web 程序中。而拦截器既可以用于 Web 程序，也可以用于 Application、Swing 等程序中。 规范不同：Filter 是 Servlet 规范中定义的，是 Servlet 容器支持的。而拦截器是在 Spring 容器内的，是 Spring 框架支持的。 使用资源不同：同其他代码块一样，Interceptor 也是一个 Spring 的组件，归 Spring 管理，配置在 Spring 文件中，因此能使用 Spring 里的任何资源、对象，例如 Service 对象、数据源、事务管理等，通过 IoC 注入拦截器即可。而 Filter 则不能。 深度不同：Filter 只在 Servlet 前后起作用。而拦截器能够深入到方法前后、异常抛出前后等。因此拦截器的使用具有更大的弹性。所以在 Spring 架构的程序中，要优先使用拦截器。 对于一个请求，拦截器、过滤器执行流程如下：\nflowchart LR A((request)) B(Filter) C(Servlet) D(Interceptor) E(Controller) F((doService)) A --\u003e B --\u003e C --\u003e D --\u003e E --\u003e F 何时使用 Filter、Interceptor？ 如果是非 Spring 项目，那么拦截器不能用，只能使用过滤器。 如果是处理 Controller 前后，既可以使用拦截器也可以使用过滤器。 如果是处理 DispatcherServlet 前后，只能使用过滤器。 Spring Boot 使用 Filter Spring Boot 使用 Filter 有两种方式：\n使用 Spring Boot 提供的 FilterRegistrationBean 注册 Filter 使用原生 Servlet 注解 @WebFilter 定义 Filter 使用 FilterRegistrationBean 注册 Filter 自定义 Filter 并实现 jakarta.servlet.Filter 。（低版本 JDK 请使用 javax.servlet.Filter） java Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import jakarta.servlet.Filter; import jakarta.servlet.FilterChain; import jakarta.servlet.ServletException; import jakarta.servlet.ServletRequest; import jakarta.servlet.ServletResponse; import java.io.IOException; public class MyFilter implements Filter { @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { // your code } } 自定义配置类配置 Filter java Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import org.springframework.boot.web.servlet.FilterRegistrationBean; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; @Configuration public class WebConfig { @Bean public FilterRegistrationBean\u003cMyFilter\u003e myFilterFilterRegistration() { FilterRegistrationBean\u003cMyFilter\u003e registrationBean = new FilterRegistrationBean\u003c\u003e(); MyFilter myFilter = new MyFilter(); registrationBean.setFilter(myFilter); return registrationBean; } } 使用原生 Servlet 注解 @WebFilter 定义 Filter 自定义 Filter 并实现 jakarta.servlet.Filter （低版本 JDK 请使用 javax.servlet.Filter），同时添加 @WebFilter 注解。 java Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import jakarta.servlet.Filter; import jakarta.servlet.FilterChain; import jakarta.servlet.ServletException; import jakarta.servlet.ServletRequest; import jakarta.servlet.ServletResponse; import jakarta.servlet.annotation.WebFilter; import java.io.IOException; @WebFilter public class MyFilter implements Filter { @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { // your code } } 在启动类上添加 @ServletComponentScan 注解 java Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.boot.web.servlet.ServletComponentScan; @SpringBootApplication @ServletComponentScan public class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); } } 自定义过滤器执行顺序 使用自定义配置类配置过滤器时，可通过 setOrder() 方法设置过滤器执行顺序。如不设置，则按照 Spring Boot Bean 加载顺序。\n使用 Servlet 原生注解 @WebFilter 时，只能通过限定 Filter 类型（按字母表 A - Z 的顺序）。注意：此方式使用 @Order 注解无效。\nSpring Boot 使用 Interceptor 当请求来到 DispatcherServlet 时，它会根据 HandlerMapping 的机制找到处理器，这样就会返回一个 HandlerExecutionChain 对象。这个对象包含处理器和拦截器。这里的拦截器会对处理器进行拦截，这样通过拦截器就可以增强处理器的功能。 ——《深入浅出 Spring Boot 2.X》- 杨开振\n拦截器的设计（Interceptor 接口） 所有的拦截器都需要实现 HandlerInterceptor 接口。该接口主要定义如下：\njava Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import jakarta.servlet.http.HttpServletRequest; import jakarta.servlet.http.HttpServletResponse; import org.springframework.lang.Nullable; public interface HandlerInterceptor { default boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { return true; } default void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, @Nullable ModelAndView modelAndView) throws Exception { } default void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, @Nullable Exception ex) throws Exception { } } 这些方法的执行流程如下：\n执行 preHandler() 方法。该方法会返回一个布尔值。如果为 false ，则结束所有流程；如果为 true ，则执行下一步 执行处理器逻辑。它包含控制器的功能。 执行 postHandle() 方法。 执行视图解析和视图渲染。 执行 afterCompletion() 方法。 开发拦截器 定义简单拦截器 实现 HandlerInterceptor 接口，并实现其方法：\njava Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import jakarta.servlet.http.HttpServletRequest; import jakarta.servlet.http.HttpServletResponse; import org.springframework.web.servlet.HandlerInterceptor; import org.springframework.web.servlet.ModelAndView; public class MyInterceptor implements HandlerInterceptor { @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(\"处理器执行前方法\"); return true; } @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(\"处理器执行后方法\"); } @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(\"处理器完成方法\"); } } 注册拦截器 新建配置类并实现 WebMvcConfigurer 接口，重写 addInterceptors(InterceptorRegistry registry) 方法：\njava Copy code 1 2 3 4 5 6 7 8 9 10 11 12 13 import org.springframework.context.annotation.Configuration; import org.springframework.web.servlet.config.annotation.InterceptorRegistry; import org.springframework.web.servlet.config.annotation.WebMvcConfigurer; @Configuration public class WebConfig implements WebMvcConfigurer { @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(new MyInterceptor()) .addPathPatterns(\"/test/*\"); } } 多个拦截器顺序 多个拦截器拦截同一路径时，采用责任链模式的规则，对于处理器前方法采用先注册先执行，而处理后方法和完成方法则是先注册后执行的规则。\n当多个拦截器中某一个处理前（preHandle()）方法为 false 时，则后续拦截器、处理器和所有拦截器的处理器后（ postHandle() ）方法都不会执行。完成方法（ afterCompletion() ）则不一样，它只会执行返回 true 的拦截器的完成方法，而且顺序是先注册后执行。\n","wordCount":"626","inLanguage":"zh","datePublished":"2024-05-07T14:14:08+08:00","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"tofuwine"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tofuwine.github.io/articles/code/java/68cf2484-e151-48cc-80e9-87a1d914a5fd/"},"publisher":{"@type":"Organization","name":"Tofuwine's Blog","logo":{"@type":"ImageObject","url":"https://tofuwine.github.io/images/favicon.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tofuwine.github.io/ accesskey=h><img src=https://tofuwine.github.io/images/profile.png alt aria-label=logo height=35>Tofuwine's Blog</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://tofuwine.github.io/articles><span>📝 文章</span></a></li><li><a href=https://tofuwine.github.io/archives><span>🗂️ 归档</span></a></li><li><a href=https://tofuwine.github.io/friend><span>🤝 友链</span></a></li><li><a href=https://tofuwine.github.io/search accesskey=/><span>🔍 搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tofuwine.github.io/>🏠 主页</a>&nbsp;»&nbsp;<a href=https://tofuwine.github.io/articles/>📝 文章</a>&nbsp;»&nbsp;<a href=https://tofuwine.github.io/articles/code/>🖥️ 计算机编程技术</a></div><h1 class="post-title entry-hint-parent">Spring 拦截器与 Servlet Filter 的区别与使用</h1><div class=post-meta><span class=x-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>2024-02-27</span></span>&nbsp;·&nbsp;<span class=x-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>626 字</span></span>&nbsp;·&nbsp;<span class=x-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>3 分钟</span></span>
<span class=x-post-meta-item>&nbsp;·&nbsp;<svg t="1714036239378" fill="currentcolor" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6659" width="256" height="256"><path d="M690 78.2c-18.6-18.8-49-19-67.8-.4s-19 49-.4 67.8l255.4 258.6c67.8 68.6 67.8 178.8.0 247.4L653.4 878.2c-18.6 18.8-18.4 49.2.4 67.8s49.2 18.4 67.8-.4l224-226.4c104.8-106 104.8-276.4.0-382.4L690 78.2zM485.4 101.4c-24-24-56.6-37.4-90.6-37.4H96C43 64 0 107 0 160v299c0 34 13.4 66.6 37.4 90.6l336 336c50 50 131 50 181 0l267-267c50-50 50-131 0-181l-336-336zM96 160h299c8.4.0 16.6 3.4 22.6 9.4l336 336c12.4 12.4 12.4 32.8.0 45.2l-267 267c-12.4 12.4-32.8 12.4-45.2.0l-336-336c-6-6-9.4-14.2-9.4-22.6V160zm192 128a64 64 0 10-128 0 64 64 0 10128 0z" p-id="6660"/></svg></span><ul class=x-post-meta-item><a href=https://tofuwine.github.io/tags/spring/>#Spring</a></ul></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c><span class=details>目录</span></summary><div class=inner><ul><li><a href=#spring-%e6%8b%a6%e6%88%aa%e5%99%a8%e4%b8%8e-servlet-filter-%e7%9a%84%e5%bc%82%e5%90%8c aria-label="Spring 拦截器与 Servlet Filter 的异同">Spring 拦截器与 Servlet Filter 的异同</a><ul><li><a href=#%e4%bd%95%e6%97%b6%e4%bd%bf%e7%94%a8-filterinterceptor aria-label="何时使用 Filter、Interceptor？">何时使用 Filter、Interceptor？</a></ul><li><a href=#spring-boot-%e4%bd%bf%e7%94%a8-filter aria-label="Spring Boot 使用 Filter">Spring Boot 使用 Filter</a><ul><li><a href=#%e4%bd%bf%e7%94%a8-filterregistrationbean-%e6%b3%a8%e5%86%8c-filter aria-label="使用 FilterRegistrationBean 注册 Filter">使用 <code>FilterRegistrationBean</code> 注册 Filter</a><li><a href=#%e4%bd%bf%e7%94%a8%e5%8e%9f%e7%94%9f-servlet-%e6%b3%a8%e8%a7%a3-webfilter-%e5%ae%9a%e4%b9%89-filter aria-label="使用原生 Servlet 注解 @WebFilter 定义 Filter">使用原生 Servlet 注解 <code>@WebFilter</code> 定义 Filter</a><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e8%bf%87%e6%bb%a4%e5%99%a8%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f aria-label=自定义过滤器执行顺序>自定义过滤器执行顺序</a></ul><li><a href=#spring-boot-%e4%bd%bf%e7%94%a8-interceptor aria-label="Spring Boot 使用 Interceptor">Spring Boot 使用 Interceptor</a><ul><li><a href=#%e6%8b%a6%e6%88%aa%e5%99%a8%e7%9a%84%e8%ae%be%e8%ae%a1interceptor-%e6%8e%a5%e5%8f%a3 aria-label="拦截器的设计（Interceptor 接口）">拦截器的设计（Interceptor 接口）</a><li><a href=#%e5%bc%80%e5%8f%91%e6%8b%a6%e6%88%aa%e5%99%a8 aria-label=开发拦截器>开发拦截器</a><ul><li><a href=#%e5%ae%9a%e4%b9%89%e7%ae%80%e5%8d%95%e6%8b%a6%e6%88%aa%e5%99%a8 aria-label=定义简单拦截器>定义简单拦截器</a><li><a href=#%e6%b3%a8%e5%86%8c%e6%8b%a6%e6%88%aa%e5%99%a8 aria-label=注册拦截器>注册拦截器</a><li><a href=#%e5%a4%9a%e4%b8%aa%e6%8b%a6%e6%88%aa%e5%99%a8%e9%a1%ba%e5%ba%8f aria-label=多个拦截器顺序>多个拦截器顺序</a></li></div></details></div></aside><script>let activeElement,elements=[];window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).parentElement.classList.add("tw-toc-active","tw-toc-open")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.scrollY>0&&getOffsetTop(e)-window.scrollY<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const n=encodeURI(e.getAttribute("id")).toLowerCase(),t=document.querySelector(`.inner ul li a[href="#${n}"]`).parentElement;e===activeElement?(t.classList.add("tw-toc-active","tw-toc-open"),getAllLIParents(t).forEach(e=>e.classList.add("tw-toc-open"))):t.classList.remove("tw-toc-active","tw-toc-open")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}function getAllLIParents(e){let n=[],t=e.parentNode;for(;t!==null;)t.tagName==="LI"&&n.push(t),t=t.parentNode;return n}</script><div class=post-content><blockquote><p>文中代码基于 Java 17</p></blockquote><h2 id=spring-拦截器与-servlet-filter-的异同>Spring 拦截器与 Servlet Filter 的异同<a hidden class=anchor aria-hidden=true href=#spring-拦截器与-servlet-filter-的异同>#</a></h2><p>Spring 的拦截器（Interceptor）与 Servlet 的 Filter 有相似之处，比如二者都是 AOP 编程思想的体现，都能实现权限检查、日志记录等。</p><p>不同的是：</p><ul><li>使用范围不同：Filter 是 Servlet 规范规定的，只能用于 Web 程序中。而拦截器既可以用于 Web 程序，也可以用于 Application、Swing 等程序中。</li><li>规范不同：Filter 是 Servlet 规范中定义的，是 Servlet 容器支持的。而拦截器是在 Spring 容器内的，是 Spring 框架支持的。</li><li>使用资源不同：同其他代码块一样，Interceptor 也是一个 Spring 的组件，归 Spring 管理，配置在 Spring 文件中，因此能使用 Spring 里的任何资源、对象，例如 Service 对象、数据源、事务管理等，通过 IoC 注入拦截器即可。而 Filter 则不能。</li><li>深度不同：Filter 只在 Servlet 前后起作用。而拦截器能够深入到方法前后、异常抛出前后等。因此拦截器的使用具有更大的弹性。所以在 Spring 架构的程序中，要优先使用拦截器。</li></ul><p>对于一个请求，拦截器、过滤器执行流程如下：</p><pre class=mermaid>flowchart LR
  A((request))
  B(Filter)
  C(Servlet)
  D(Interceptor)
  E(Controller)
  F((doService))
  
  A --> B --> C --> D --> E --> F
</pre><h3 id=何时使用-filterinterceptor>何时使用 Filter、Interceptor？<a hidden class=anchor aria-hidden=true href=#何时使用-filterinterceptor>#</a></h3><ul><li>如果是非 Spring 项目，那么拦截器不能用，只能使用过滤器。</li><li>如果是处理 <code>Controller</code> 前后，既可以使用拦截器也可以使用过滤器。</li><li>如果是处理 <code>DispatcherServlet</code> 前后，只能使用过滤器。</li></ul><h2 id=spring-boot-使用-filter>Spring Boot 使用 Filter<a hidden class=anchor aria-hidden=true href=#spring-boot-使用-filter>#</a></h2><p>Spring Boot 使用 Filter 有两种方式：</p><ul><li>使用 Spring Boot 提供的 <code>FilterRegistrationBean</code> 注册 Filter</li><li>使用原生 Servlet 注解 <code>@WebFilter</code> 定义 Filter</li></ul><h3 id=使用-filterregistrationbean-注册-filter>使用 <code>FilterRegistrationBean</code> 注册 Filter<a hidden class=anchor aria-hidden=true href=#使用-filterregistrationbean-注册-filter>#</a></h3><ol><li>自定义 Filter 并实现 <code>jakarta.servlet.Filter</code> 。（低版本 JDK 请使用 <code>javax.servlet.Filter</code>）</li></ol><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.Filter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.FilterChain</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.io.IOException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyFilter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Filter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>doFilter</span><span class=p>(</span><span class=n>ServletRequest</span><span class=w> </span><span class=n>servletRequest</span><span class=p>,</span><span class=w> </span><span class=n>ServletResponse</span><span class=w> </span><span class=n>servletResponse</span><span class=p>,</span><span class=w> </span><span class=n>FilterChain</span><span class=w> </span><span class=n>filterChain</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=p>,</span><span class=w> </span><span class=n>ServletException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// your code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><ol start=2><li>自定义配置类配置 Filter</li></ol><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.web.servlet.FilterRegistrationBean</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Bean</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Configuration</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>WebConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>FilterRegistrationBean</span><span class=o>&lt;</span><span class=n>MyFilter</span><span class=o>&gt;</span><span class=w> </span><span class=nf>myFilterFilterRegistration</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>FilterRegistrationBean</span><span class=o>&lt;</span><span class=n>MyFilter</span><span class=o>&gt;</span><span class=w> </span><span class=n>registrationBean</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>FilterRegistrationBean</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>MyFilter</span><span class=w> </span><span class=n>myFilter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MyFilter</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>registrationBean</span><span class=p>.</span><span class=na>setFilter</span><span class=p>(</span><span class=n>myFilter</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>registrationBean</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=使用原生-servlet-注解-webfilter-定义-filter>使用原生 Servlet 注解 <code>@WebFilter</code> 定义 Filter<a hidden class=anchor aria-hidden=true href=#使用原生-servlet-注解-webfilter-定义-filter>#</a></h3><ol><li>自定义 Filter 并实现 <code>jakarta.servlet.Filter</code> （低版本 JDK 请使用 <code>javax.servlet.Filter</code>），同时添加 <code>@WebFilter</code> 注解。</li></ol><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.Filter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.FilterChain</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.ServletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.annotation.WebFilter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.io.IOException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@WebFilter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyFilter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Filter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>doFilter</span><span class=p>(</span><span class=n>ServletRequest</span><span class=w> </span><span class=n>servletRequest</span><span class=p>,</span><span class=w> </span><span class=n>ServletResponse</span><span class=w> </span><span class=n>servletResponse</span><span class=p>,</span><span class=w> </span><span class=n>FilterChain</span><span class=w> </span><span class=n>filterChain</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=p>,</span><span class=w> </span><span class=n>ServletException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// your code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><ol start=2><li>在启动类上添加 <code>@ServletComponentScan</code> 注解</li></ol><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.SpringApplication</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.autoconfigure.SpringBootApplication</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.web.servlet.ServletComponentScan</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@SpringBootApplication</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@ServletComponentScan</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Application</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SpringApplication</span><span class=p>.</span><span class=na>run</span><span class=p>(</span><span class=n>Application</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=自定义过滤器执行顺序>自定义过滤器执行顺序<a hidden class=anchor aria-hidden=true href=#自定义过滤器执行顺序>#</a></h3><p>使用自定义配置类配置过滤器时，可通过 <code>setOrder()</code> 方法设置过滤器执行顺序。如不设置，则按照 Spring Boot Bean 加载顺序。</p><p>使用 Servlet 原生注解 <code>@WebFilter</code> 时，只能通过限定 Filter 类型（按字母表 A - Z 的顺序）。注意：此方式使用 <code>@Order</code> 注解无效。</p><h2 id=spring-boot-使用-interceptor>Spring Boot 使用 Interceptor<a hidden class=anchor aria-hidden=true href=#spring-boot-使用-interceptor>#</a></h2><blockquote><p>当请求来到 <code>DispatcherServlet</code> 时，它会根据 <code>HandlerMapping</code> 的机制找到处理器，这样就会返回一个 <code>HandlerExecutionChain</code> 对象。这个对象包含处理器和拦截器。这里的拦截器会对处理器进行拦截，这样通过拦截器就可以增强处理器的功能。 ——《深入浅出 Spring Boot 2.X》- 杨开振</p></blockquote><h3 id=拦截器的设计interceptor-接口>拦截器的设计（Interceptor 接口）<a hidden class=anchor aria-hidden=true href=#拦截器的设计interceptor-接口>#</a></h3><p>所有的拦截器都需要实现 <code>HandlerInterceptor</code> 接口。该接口主要定义如下：</p><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.http.HttpServletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.http.HttpServletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.lang.Nullable</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>HandlerInterceptor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>default</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>preHandle</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>default</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>postHandle</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>,</span><span class=w> </span><span class=nd>@Nullable</span><span class=w> </span><span class=n>ModelAndView</span><span class=w> </span><span class=n>modelAndView</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>default</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>afterCompletion</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>,</span><span class=w> </span><span class=nd>@Nullable</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><p>这些方法的执行流程如下：</p><ol><li>执行 <code>preHandler()</code> 方法。该方法会返回一个布尔值。如果为 <code>false</code> ，则结束所有流程；如果为 <code>true</code> ，则执行下一步</li><li>执行处理器逻辑。它包含控制器的功能。</li><li>执行 <code>postHandle()</code> 方法。</li><li>执行视图解析和视图渲染。</li><li>执行 <code>afterCompletion()</code> 方法。</li></ol><h3 id=开发拦截器>开发拦截器<a hidden class=anchor aria-hidden=true href=#开发拦截器>#</a></h3><h4 id=定义简单拦截器>定义简单拦截器<a hidden class=anchor aria-hidden=true href=#定义简单拦截器>#</a></h4><p>实现 <code>HandlerInterceptor</code> 接口，并实现其方法：</p><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.http.HttpServletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>jakarta.servlet.http.HttpServletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.servlet.HandlerInterceptor</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.servlet.ModelAndView</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MyInterceptor</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>HandlerInterceptor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>preHandle</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;处理器执行前方法&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>postHandle</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>,</span><span class=w> </span><span class=n>ModelAndView</span><span class=w> </span><span class=n>modelAndView</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;处理器执行后方法&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>afterCompletion</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>handler</span><span class=p>,</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;处理器完成方法&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h4 id=注册拦截器>注册拦截器<a hidden class=anchor aria-hidden=true href=#注册拦截器>#</a></h4><p>新建配置类并实现 <code>WebMvcConfigurer</code> 接口，重写 <code>addInterceptors(InterceptorRegistry registry)</code> 方法：</p><div class="tw-code-block-container tw-code-details open"><div class="tw-code-block-header tw-code-details-summary"><div class=tw-code-block-header-left>java</div><div class=tw-code-block-header-center><span></span></div><div class=tw-code-block-header-right><button class=tw-code-copy-button>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentcolor"/></svg>Copy code</button></div></div><div class=tw-code-details-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Configuration</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.servlet.config.annotation.InterceptorRegistry</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.servlet.config.annotation.WebMvcConfigurer</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>WebConfig</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>WebMvcConfigurer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>addInterceptors</span><span class=p>(</span><span class=n>InterceptorRegistry</span><span class=w> </span><span class=n>registry</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>registry</span><span class=p>.</span><span class=na>addInterceptor</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>MyInterceptor</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>addPathPatterns</span><span class=p>(</span><span class=s>&#34;/test/*&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h4 id=多个拦截器顺序>多个拦截器顺序<a hidden class=anchor aria-hidden=true href=#多个拦截器顺序>#</a></h4><p>多个拦截器拦截同一路径时，采用责任链模式的规则，对于处理器前方法采用<strong>先注册先执行</strong>，而处理后方法和完成方法则是<strong>先注册后执行</strong>的规则。</p><blockquote><p>当多个拦截器中某一个处理前（<code>preHandle()</code>）方法为 <code>false</code> 时，则后续拦截器、处理器和所有拦截器的处理器后（ <code>postHandle()</code> ）方法都不会执行。完成方法（ <code>afterCompletion()</code> ）则不一样，它只会执行返回 <code>true</code> 的拦截器的完成方法，而且顺序是<strong>先注册后执行</strong>。</p></blockquote></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div class=tw-reward-button><a href=javascript:void(0); onclick='document.getElementById("tw-qr-overlay").style.display="block"'>赞赏</a></div><div id=tw-qr-overlay style=display:none><div class=tw-qr><div id=wechat class=tw-qrcode><a class=fancybox rel=group><img id=wechat_qr src=https://tofuwine.github.io/images/wechat_pay.jpg alt=wechat_pay></a><p>微信</p></div><div id=alipay class=tw-qrcode><a class=fancybox rel=group><img id=alipay_qr src=https://tofuwine.github.io/images/alipay.jpg alt=alipay></a><p>支付宝</p></div></div></div><p>如果本文对你有所帮助，可以点击上方赞赏按钮请作者喝杯咖啡！</p></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://tofuwine.github.io/tags/spring/>Spring</a></li></ul><nav class=paginav><a class=prev href=https://tofuwine.github.io/articles/code/z/28095def-16f4-4aab-a023-8937447fa34f/><span class=title>« 上一页</span><br><span>FreeMarker 基本用法</span></a></nav></footer><div class=comments-title id=comment><p class=x-comments-title>欢迎来到评论区</p><p style=font-size:1rem>感谢您的耐心阅读！来选个表情，或者留个评论吧！</p></div><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"tofuwine/tofuwine.github.io","data-repo-id":"R_kgDOLz45lw","data-category":"Announcements","data-category-id":"DIC_kwDOLz45l84CfBDJ","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":getStoredTheme(),"data-lang":"zh-CN","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2024 <a href=https://tofuwine.github.io/>Tofuwine's Blog</a> All Rights Reserved</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" class=top-link id=top-link accesskey=g><span class=tw-top-inner><svg class="tw-top-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
<span id=tw-read-progress></span>
</span></a><script>let detail=document.getElementsByClassName("details");details=[].slice.call(detail);for(let e=0;e<details.length;e++){let t=details[e];const n=t.getElementsByClassName("details-summary")[0];n&&n.addEventListener("click",()=>{t.classList.toggle("open")},!1)}</script><a href=#comment aria-label="go to bottom comment" class="top-link bottom-comment" id=bottom-comment accesskey=b style=visibility:visible;opacity:1><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29.338 29.338" fill="currentcolor"><path d="M27.184 1.605H2.156C.967 1.605.0 2.572.0 3.76v17.572c0 1.188.967 2.155 2.156 2.155h13.543l5.057 3.777c.414.31.842.468 1.268.468.789.0 1.639-.602 1.637-1.923v-2.322h3.523c1.188.0 2.154-.967 2.154-2.155V3.76C29.338 2.572 28.371 1.605 27.184 1.605zM27.34 21.332c0 .085-.068.155-.154.155h-5.523v3.955l-5.297-3.956H2.156c-.086.0-.154-.07-.154-.155V3.759c0-.085.068-.155.154-.155v.001h25.029c.086.0.154.07.154.155L27.34 21.332zM5.505 10.792h4.334v4.333H5.505V10.792zm7 0h4.334v4.333h-4.334V10.792zm7 0h4.334v4.333h-4.334V10.792z"/></svg>
</a><script>let comment=document.getElementById("comment"),bottomToComment=document.getElementById("bottom-comment");document.addEventListener("scroll",function(){const e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t=comment.offsetTop,n=document.documentElement.scrollTop,s=t-n;s<=e+100?(bottomToComment.style.visibility="hidden",bottomToComment.style.opacity="0"):(bottomToComment.style.visibility="visible",bottomToComment.style.opacity="1")})</script><button id=theme-toggle-float accesskey=t class="top-link theme-toggle-float" style=visibility:visible;opacity:1>
<svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="3 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="3 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
<script>document.getElementById("theme-toggle-float").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>const goTopButton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(goTopButton.style.visibility="visible",goTopButton.style.opacity="1"):(goTopButton.style.visibility="hidden",goTopButton.style.opacity="0")},document.addEventListener("scroll",function(){const s=document.getElementById("tw-read-progress"),o=document.documentElement.scrollHeight,i=document.documentElement.clientHeight,t=document.documentElement.scrollTop||document.body.scrollTop,n=((t/(o-i)).toFixed(2)*100).toFixed(0);s.innerText=n,n==="100"&&(document.body.classList.add("tw-bottom-jump"),setTimeout(function(){document.body.classList.remove("tw-bottom-jump")},500)),t===0&&(document.body.classList.add("tw-top-jump"),setTimeout(function(){document.body.classList.remove("tw-top-jump")},500))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.closest(".tw-code-block-container"),t=s.querySelector("button");function n(){t.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.0633 5.67375C18.5196 5.98487 18.6374 6.607 18.3262 7.06331L10.8262 18.0633C10.6585 18.3093 10.3898 18.4678 10.0934 18.4956C9.79688 18.5234 9.50345 18.4176 9.29289 18.2071L4.79289 13.7071C4.40237 13.3166 4.40237 12.6834 4.79289 12.2929C5.18342 11.9023 5.81658 11.9023 6.20711 12.2929L9.85368 15.9394L16.6738 5.93664C16.9849 5.48033 17.607 5.36263 18.0633 5.67375Z" fill="currentColor"></path></svg>Copied！',setTimeout(()=>{t.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="tw-icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5c-1.1046.0-2 .89543-2 2h4c0-1.10457-.8954-2-2-2zm-3.46487.0C9.22675 2.3044 10.5194 1.5 12 1.5s2.7733.8044 3.4649 2H17.25c1.6569.0 3 1.34315 3 3v12c0 1.6569-1.0931 3-3 3H6.75c-1.65685.0-3-1.3431-3-3V6.5c0-1.65685 1.34315-3 3-3H8.53513zM8 5.5H6.75c-.55228.0-1 .44772-1 1v12c0 .552299999999999.44772 1 1 1h10.5C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5c0-.55228-.447700000000001-1-1-1H16c0 1.10457-.8954 2-2 2H10c-1.10457.0-2-.89543-2-2z" fill="currentColor"></path></svg>Copy code'},2e3)}t.addEventListener("click",t=>{if(t.stopPropagation(),"clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)})})</script><script>window.onclick=function(e){const t=document.getElementById("tw-qr-overlay");e.target===t&&(t.style.display="none")}</script><script>let twCodeDetail=document.getElementsByClassName("tw-code-details");twCodeDetails=[].slice.call(twCodeDetail);for(let e=0;e<twCodeDetails.length;e++){let t=twCodeDetails[e];const n=t.getElementsByClassName("tw-code-details-summary")[0];n&&n.addEventListener("click",()=>{t.classList.toggle("open")},!1)}</script></body></html>